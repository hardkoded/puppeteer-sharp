version: 1.0.{build}
branches:
  only:
  - master
image: Previous Visual Studio 2017
configuration: Release
before_build:
- ps: >-
    dotnet restore .\lib\PuppeteerSharp.sln

    Import-Module WebAdministration

    New-SelfSignedCertificate -Subject "localhost" -FriendlyName "localhost" -CertStoreLocation "cert:\LocalMachine\My"

    Get-ChildItem -Path cert:\LocalMachine\my | where { $_.subject -eq "CN=localhost" } | Export-Certificate -FilePath C:\projects\puppeteer-sharp\lib\PuppeteerSharp.TestServer\testCert.cer

build:
  project: .\lib\PuppeteerSharp.sln
  publish_nuget: true
  include_nuget_references: true
  verbosity: minimal
test_script:
- cmd: >-
    cd .\lib\PuppeteerSharp.Tests

    dotnet test -s test.runsettings